export default function Popup(t){let e=document.querySelector("body"),s=(document.querySelector("html"),"object"==typeof t&&!!t.saveID),i=!0,o=!0;const n=function(o,n){if(i){i=!1;let c=document.querySelector(o);if(!c)return new Error(`Not found "${o}"`);c.classList.contains("popup")&&(c.style.display="flex",e.classList.add("is-popup-active"),s&&!c.classList.contains("not-save-id")&&history.pushState("","",o),c.classList.add("is-open"),t.onOpen(),setTimeout(()=>{n?(c.classList.add("is-transition-none"),c.classList.add("is-active"),i=!0):(c.classList.add("is-active"),setTimeout(()=>i=!0,400))},100))}else setTimeout(()=>i=!0,500)},c=function(t){if(o){let i;o=!1,i="string"==typeof t?document.querySelector(t):t.closest(".popup"),i&&(i.classList.contains("is-transition-none")&&i.classList.remove("is-transition-none"),document.querySelectorAll(".header__nav_list > li > a.is-open").forEach(t=>{t.getAttribute("href")=="#"+i.getAttribute("id")&&t.classList.remove("is-open")}),setTimeout(()=>{i.classList.remove("is-active"),setTimeout((function(){const t=document.querySelectorAll(".popup.is-active");t.length<1&&e.classList.remove("is-popup-active"),s&&(!function(){let t=window.location.toString();if(t.indexOf("#")>0){let e=t.substring(0,t.indexOf("#"));window.history.replaceState({},document.title,e)}}(),t[t.length-1]&&history.pushState("","","#"+t[t.length-1].getAttribute("id"))),o=!0,i.classList.remove("is-open"),i.classList.contains("nav_popup")||i.classList.contains("nav_popup_2")||(i.style.display="none")}),400)},0))}};return{open:function(t){n(t)},close:function(t){c(t)},init:function(){let t;if(e.addEventListener("click",(function(e){t=e.target;let s=t.closest(".open-popup");s&&(e.preventDefault(),n(s.getAttribute("href")));let i=t.closest(".popup-close");i&&c(i)})),e.addEventListener("keyup",(function(t){"Escape"==t.key&&document.querySelector(".popup.is-active")&&c(document.querySelector(".popup.is-active"))})),window.addEventListener("popstate",(function(t){t.preventDefault();let e=window.location.hash;""===e&&document.body.classList.contains("is-popup-active")?c(document.querySelector(".popup.is-active")):""===e||document.body.classList.contains("is-popup-active")||n(e,!1)})),s){let t=new URL(window.location);t.hash&&n(t.hash,!0)}}}}