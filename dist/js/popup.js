export default function Popup(t){let e,s=document.querySelector("body"),i=(document.querySelector("html"),"object"==typeof t&&!!t.saveID),o=!0,n=!0;const c=function(e,n){if(o){o=!1;let c=document.querySelector(e);if(!c)return new Error(`Not found "${e}"`);c.classList.contains("popup")&&(c.style.display="flex",s.classList.add("is-popup-active"),i&&!c.classList.contains("not-save-id")&&history.pushState("","",e),c.classList.add("is-open"),t.onOpen(),setTimeout(()=>{n?(c.classList.add("is-transition-none"),c.classList.add("is-active"),o=!0):(c.classList.add("is-active"),setTimeout(()=>o=!0,400))},100))}else setTimeout(()=>o=!0,500)},a=function(t){if(n){let o;n=!1,o="string"==typeof t?document.querySelector(t):t.closest(".popup"),o&&(o.classList.contains("is-transition-none")&&o.classList.remove("is-transition-none"),document.querySelectorAll(".header__nav_list > li > button.is-open").forEach(t=>{t.dataset.for+o.getAttribute("id")&&(clearTimeout(e),e=setTimeout(()=>{o.classList.contains("is-active")||o.classList.remove("is-active-2")},400),t.classList.remove("is-open"))}),setTimeout(()=>{o.classList.remove("is-active"),setTimeout((function(){const t=document.querySelectorAll(".popup.is-active");t.length<1&&s.classList.remove("is-popup-active"),i&&(!function(){let t=window.location.toString();if(t.indexOf("#")>0){let e=t.substring(0,t.indexOf("#"));window.history.replaceState({},document.title,e)}}(),t[t.length-1]&&history.pushState("","","#"+t[t.length-1].getAttribute("id"))),n=!0,o.classList.remove("is-open"),o.classList.contains("nav_popup")||o.classList.contains("nav_popup_2")||(o.style.display="none")}),400)},0))}};return{open:function(t){c(t)},close:function(t){a(t)},init:function(){let t;if(s.addEventListener("click",(function(e){t=e.target;let s=t.closest(".open-popup");s&&(e.preventDefault(),s.getAttribute("href")?c(s.getAttribute("href")):s.dataset.for&&c("#"+s.dataset.for));let i=t.closest(".popup-close");i&&a(i)})),s.addEventListener("keyup",(function(t){"Escape"==t.key&&document.querySelector(".popup.is-active")&&a(document.querySelector(".popup.is-active"))})),window.addEventListener("popstate",(function(t){t.preventDefault();let e=window.location.hash;""===e&&document.body.classList.contains("is-popup-active")?a(document.querySelector(".popup.is-active")):""===e||document.body.classList.contains("is-popup-active")||c(e,!1)})),i){let t=new URL(window.location);t.hash&&c(t.hash,!0)}}}}